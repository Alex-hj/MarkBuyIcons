# .github/workflows/generate-icon-list.yml

name: Generate Icon JSON

# 触发条件：当推送到 master 分支时触发
on:
  push:
    branches:
      - master  # 如果你的主分支是 master，请改成 master

jobs:
  build:
    runs-on: ubuntu-latest # 使用最新的 Ubuntu 虚拟机环境

    steps:
      # 第一步：检出仓库代码
      - name: Checkout repository
        uses: actions/checkout@v4

      # 第二步：设置 Node.js 环境
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18' 

      # 第三步：运行脚本生成 icons.json
      - name: Generate icon list
        run: node generate-json.js

      # 第四步：自动提交和推送更新后的 icons.json 文件
      - name: Commit and push if changed
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: 自动更新图标列表 auro-update icon list"
          file_pattern: icons.json # 只提交 icons.json 文件的变动
          commit_user_name: "GitHub Actions Bot" # 提交者名称
          commit_user_email: "actions@github.com" # 提交者邮箱
          commit_author: "GitHub Actions Bot <actions@github.com>"